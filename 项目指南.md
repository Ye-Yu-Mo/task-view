# 通用快速开发指南

## 项目概述

本指南提供了基于现代化技术栈的全栈开发快速入门指南，帮助开发者在最短时间内搭建起完整的开发环境并开始业务开发。

**推荐技术栈组合**：
- **前端**: Vite + React + TypeScript + Tailwind CSS
- **后端**: Rust + Axum + SeaORM + SQLite
- **工具**: Git, VS Code, Docker

## 🚀 快速开始

### 第一步：环境准备

#### 必需工具安装
```bash
# 1. Node.js 18+ (前端)
npm install -g npm@latest
node --version  # 检查版本

# 2. Rust 1.70+ (后端)
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
source ~/.cargo/env
rustc --version

# 3. SQLite 3.40+ (数据库)
# macOS
brew install sqlite
# Ubuntu
sudo apt-get install sqlite3

# 4. Git (版本控制)
git --version

# 5. Docker (可选)
# 参考官方文档安装适合你系统的版本
```

#### 开发工具推荐
```bash
# VS Code 扩展
- Rust Analyzer      # Rust 语言支持
- Thunder Client     # API 测试
- Tailwind CSS IntelliSense  # CSS 智能提示
- ES7+ React/Redux/React-Native snippets
- Prettier - Code formatter
- ESLint
```

### 第二步：项目初始化

#### 创建项目目录
```bash
mkdir project-name && cd project-name
git init
touch .gitignore
```

#### Git 忽略文件模板
```gitignore
# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
pnpm-debug.log*
lerna-debug.log*

node_modules
dist
dist-ssr
*.local

# Editor directories and files
.vscode/*
!.vscode/extensions.json
.idea
.DS_Store
*.suo
*.ntvs*
*.njsproj
*.sln
*.sw?

# Rust
/target
**/*.rs.bk
Cargo.lock

# Environment variables
.env
.env.local
.env.development.local
.env.test.local
.env.production.local

# Database
*.db
*.sqlite
```

#### 前端项目搭建
```bash
# 创建 Vite + React 项目
npm create vite@latest frontend -- --template react-ts
cd frontend

# 安装核心依赖
npm install tailwindcss @tailwindcss/vite

# 安装常用依赖
npm install \
  @tanstack/react-query \
  react-router-dom \
  react-hook-form \
  @hookform/resolvers \
  yup \
  axios \
  lucide-react 

npm install -D @types/node

cd ..
```

#### 后端项目搭建
```bash
# 创建 Rust 项目
cargo new backend
cd backend

# 配置 Cargo.toml
```

**Cargo.toml 配置**：
```toml
[package]
name = "backend"
version = "0.1.0"
edition = "2021"

[dependencies]
# Web框架
axum = "0.7"
tower = "0.4"
tower-http = { version = "0.5", features = ["cors", "trace"] }
tokio = { version = "1.0", features = ["full"] }

# 数据库
sea-orm = { version = "0.12", features = ["sqlx-sqlite", "runtime-tokio-rustls", "macros", "chrono", "uuid"] }

# 序列化
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"

# JWT 认证
jsonwebtoken = "9.2"
bcrypt = "0.15"

# 工具类
uuid = { version = "1.6", features = ["v4", "serde"] }
chrono = { version = "0.4", features = ["serde"] }
anyhow = "1.0"
tracing = "0.1"
tracing-subscriber = "0.3"
dotenvy = "0.15"

cd ..
```

### 第三步：基础配置

#### 前端配置

**vite.config.ts**：
```typescript
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import tailwindcss from '@tailwindcss/vite'
import path from 'path'

export default defineConfig({
  plugins: [
    react(),
    tailwindcss(),
  ],
  resolve: {
    alias: {
      "@": path.resolve(__dirname, "./src"),
    },
  },
  server: {
    port: 5173,
    proxy: {
      '/api': {
        target: 'http://127.0.0.1:20000',
        changeOrigin: true,
      }
    }
  }
})
```

**src/index.css**：
```css
@import "tailwindcss";

/* 全局样式 */
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
```

#### 后端配置

**src/main.rs**：
```rust
use anyhow::Result;
use axum::{http::{header, Method}, routing::get, Router};
use std::net::SocketAddr;
use tower_http::cors::{Any, CorsLayer};

mod config;
mod database;
mod handlers;

#[tokio::main]
async fn main() -> Result<()> {
    tracing_subscriber::fmt::init();

    let cors = CorsLayer::new()
        .allow_methods([Method::GET, Method::POST, Method::PUT, Method::DELETE])
        .allow_headers([header::CONTENT_TYPE, header::AUTHORIZATION])
        .allow_origin(Any);

    let app = Router::new()
        .route("/api/health", get(handlers::health_check))
        .layer(cors);

    let addr = SocketAddr::from(([127, 0, 0, 1], 20000));
    println!("Server running on http://{}", addr);

    let listener = tokio::net::TcpListener::bind(addr).await?;
    axum::serve(listener, app).await?;

    Ok(())
}
```

**src/handlers.rs**：
```rust
use axum::{http::StatusCode, Json};
use serde_json::{json, Value};

pub async fn health_check() -> Result<Json<Value>, StatusCode> {
    Ok(Json(json!({
        "status": "ok",
        "message": "服务运行正常",
        "timestamp": chrono::Utc::now().to_rfc3339()
    })))
}
```

**环境配置 (.env)**：
```bash
DATABASE_URL=sqlite://database.db
JWT_SECRET=your-very-secure-jwt-secret-key-32chars-min
PORT=20000
RUST_LOG=info
```

### 第四步：启动开发服务

#### 启动后端服务
```bash
cd backend

# 创建数据库文件
touch database.db

# 启动开发服务
cargo run
# 访问: http://127.0.0.1:20000/api/health
```

#### 启动前端服务
```bash
# 新终端窗口
cd frontend

# 启动开发服务
npm run dev
# 访问: http://localhost:5173
```

## 📁 推荐项目结构

```
project-name/
├── frontend/                    # 前端项目
│   ├── src/
│   │   ├── components/         # 可复用组件
│   │   │   ├── ui/            # 基础 UI 组件
│   │   │   ├── layout/        # 布局组件
│   │   │   └── forms/         # 表单组件
│   │   ├── pages/             # 页面组件
│   │   │   ├── auth/          # 认证页面
│   │   │   ├── dashboard/     # 仪表板
│   │   │   └── [业务模块]/    # 业务相关页面
│   │   ├── hooks/             # 自定义 Hooks
│   │   ├── services/          # API 服务
│   │   │   ├── api.ts         # Axios 配置
│   │   │   ├── auth.ts        # 认证服务
│   │   │   └── [业务].ts      # 业务相关服务
│   │   ├── types/             # TypeScript 类型
│   │   ├── utils/             # 工具函数
│   │   ├── context/           # React Context
│   │   └── constants/         # 常量定义
│   ├── vite.config.ts
│   └── package.json
├── backend/                     # 后端项目
│   ├── src/
│   │   ├── handlers/          # 路由处理器
│   │   │   ├── auth.rs        # 认证路由
│   │   │   ├── [业务].rs      # 业务相关路由
│   │   │   └── mod.rs
│   │   ├── models/            # 数据模型
│   │   ├── services/          # 业务逻辑
│   │   ├── middleware/        # 中间件
│   │   ├── database.rs        # 数据库配置
│   │   ├── config.rs          # 配置管理
│   │   └── main.rs           # 入口文件
│   ├── migrations/            # 数据库迁移
│   ├── Cargo.toml
│   └── .env
├── docs/                       # 文档
│   ├── API文档.md
│   └── 开发指南.md
└── README.md
```

## 🛠️ 开发工作流

### 1. 功能开发流程

#### 新功能开发通用步骤

**后端开发步骤**：
1. 创建数据模型（src/models/[model].rs）
2. 创建服务层（src/services/[service].rs）
3. 创建路由处理器（src/handlers/[handler].rs）
4. 注册路由（src/main.rs）
5. 测试 API 接口

**前端开发步骤**：
1. 创建 API 服务（src/services/[service].ts）
2. 创建类型定义（src/types/[type].ts）
3. 创建页面组件或更新现有组件
4. 创建自定义 Hook（如需）
5. 集成到路由系统

### 2. 常用开发命令

#### 前端命令
```bash
# 开发服务
npm run dev

# 类型检查
npx tsc --noEmit

# 构建
npm run build

# 代码检查
npm run lint

# 预览构建结果
npm run preview
```

#### 后端命令
```bash
# 开发运行
cargo run

# 代码检查
cargo check

# 运行测试
cargo test

# 格式化代码
cargo fmt

# 代码静态分析
cargo clippy

# 热重载开发
cargo install cargo-watch
cargo watch -x run
```

### 3. 调试技巧

#### 前端调试
```typescript
// React DevTools 浏览器扩展
// 控制台调试
console.log('Debug info:', data);

// React Query DevTools
import { ReactQueryDevtools } from '@tanstack/react-query-devtools'

function App() {
  return (
    <>
      {/* 你的应用 */}
      <ReactQueryDevtools initialIsOpen={false} />
    </>
  );
}
```

#### 后端调试
```rust
// 日志调试
tracing::info!("User created: {:?}", user);
tracing::error!("Database error: {}", error);

// 断点调试（VS Code + CodeLLDB）
// 在 .vscode/launch.json 中配置

// 单元测试
#[cfg(test)]
mod tests {
    use super::*;

    #[tokio::test]
    async fn test_function() {
        // 测试逻辑
    }
}
```

## 🔧 常用代码模板

### 1. 前端组件模板

#### React 函数组件
```typescript
import React from 'react';

interface ComponentProps {
  // 定义属性类型
  title: string;
  onAction: () => void;
}

export const ComponentName: React.FC<ComponentProps> = ({ title, onAction }) => {
  return (
    <div className="bg-white p-4 rounded-lg shadow-sm">
      <h2 className="text-lg font-semibold mb-2">{title}</h2>
      <button 
        onClick={onAction}
        className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors"
      >
        操作按钮
      </button>
    </div>
  );
};
```

#### 自定义 Hook
```typescript
import { useState, useEffect } from 'react';

interface DataItem {
  id: string;
  name: string;
}

export const useDataFetch = (url: string) => {
  const [data, setData] = useState<DataItem[]>([]);
  const [loading, setLoading] = useState<boolean>(true);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    const fetchData = async () => {
      try {
        setLoading(true);
        const response = await fetch(url);
        if (!response.ok) throw new Error('Network response was not ok');
        const result = await response.json();
        setData(result);
      } catch (err) {
        setError(err instanceof Error ? err.message : 'Unknown error');
      } finally {
        setLoading(false);
      }
    };

    fetchData();
  }, [url]);

  return { data, loading, error };
};
```

### 2. 后端代码模板

#### 路由处理器
```rust
use axum::{extract::{Path, State}, http::StatusCode, Json};
use serde::{Deserialize, Serialize};

use crate::database::Database;

#[derive(Deserialize)]
pub struct CreateRequest {
    pub name: String,
    pub value: Option<String>,
}

#[derive(Serialize)]
pub struct Response {
    pub id: String,
    pub name: String,
    pub value: Option<String>,
    pub created_at: String,
}

pub async fn create_item(
    State(db): State<Database>,
    Json(payload): Json<CreateRequest>,
) -> Result<Json<Response>, StatusCode> {
    // 业务逻辑实现
    let id = uuid::Uuid::new_v4().to_string();
    
    // 这里应该调用数据库服务
    let item = Response {
        id,
        name: payload.name,
        value: payload.value,
        created_at: chrono::Utc::now().to_rfc3339(),
    };
    
    Ok(Json(item))
}
```

#### 数据库模型
```rust
use sea_orm::entity::prelude::*;

#[derive(Clone, Debug, PartialEq, DeriveEntityModel)]
#[sea_orm(table_name = "items")]
pub struct Model {
    #[sea_orm(primary_key)]
    pub id: String,
    pub name: String,
    pub value: Option<String>,
    pub created_at: DateTimeWithTimeZone,
    pub updated_at: DateTimeWithTimeZone,
}

#[derive(Copy, Clone, Debug, EnumIter, DeriveRelation)]
pub enum Relation {
    // 定义关系
}

impl ActiveModelBehavior for ActiveModel {
    fn new() -> Self {
        let now = chrono::Utc::now();
        Self {
            created_at: Set(now),
            updated_at: Set(now),
            ..ActiveModelTrait::default()
        }
    }

    fn before_save(mut self, insert: bool) -> Result<Self, DbErr> {
        self.updated_at = Set(chrono::Utc::now());
        Ok(self)
    }
}
```

## 🚀 部署指南

### 1. 前端部署

#### 构建静态文件
```bash
cd frontend
npm run build
# 构建产物在 dist 目录
```

#### Nginx 配置
```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    root /path/to/frontend/dist;
    index index.html;
    
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    location /api/ {
        proxy_pass http://127.0.0.1:20000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

### 2. 后端部署

#### 编译优化
```bash
cd backend
cargo build --release
# 构建产物在 target/release/ 目录
```

**Cargo.toml 优化配置**：
```toml
[profile.release]
opt-level = 3           # 最高优化级别
lto = "fat"            # 链接时优化
codegen-units = 1      # 减少代码生成单元，提高优化效果
panic = "abort"        # 生产环境使用 abort 而非 unwind
strip = true           # 移除调试符号，减小文件大小
```

#### Docker 部署

**Dockerfile**：
```dockerfile
FROM rust:1.70-slim as builder
WORKDIR /app
COPY . .
RUN cargo build --release

FROM debian:bullseye-slim
RUN apt-get update && apt-get install -y ca-certificates sqlite3
WORKDIR /app
COPY --from=builder /app/target/release/backend .
COPY --from=builder /app/migrations /app/migrations
EXPOSE 20000
CMD ["./backend"]
```

**docker-compose.yml**：
```yaml
version: '3.8'

services:
  backend:
    build: ./backend
    ports:
      - "20000:20000"
    volumes:
      - ./data:/app/data
    environment:
      - DATABASE_URL=sqlite:///app/data/database.db
      - JWT_SECRET=your-secret-key
      - RUST_LOG=info
    restart: unless-stopped

  frontend:
    build: ./frontend
    ports:
      - "80:80"
    depends_on:
      - backend
    restart: unless-stopped
```

## 🛠️ 推荐工具

### 前端开发工具
- **React Query** - 服务器状态管理，简化数据获取和缓存
- **React Hook Form** - 高性能、灵活的表单处理库
- **Lucide React** - 现代化的开源图标库
- **Axios** - 基于 Promise 的 HTTP 客户端
- **TypeScript** - 类型安全的 JavaScript 超集
- **Tailwind CSS** - 实用优先的 CSS 框架

### 后端开发工具
- **SeaORM** - 异步 ORM 框架，支持数据库迁移
- **Axum** - 面向未来的 Web 框架
- **tracing** - 结构化日志系统
- **dotenvy** - 环境变量管理
- **jsonwebtoken** - JWT 认证实现
- **bcrypt** - 密码哈希库

### 开发辅助工具
- **VS Code** - 现代化代码编辑器
- **Thunder Client** - VS Code 内置的 API 测试工具
- **Git** - 版本控制系统
- **Docker** - 容器化平台
- **Rust Analyzer** - 强大的 Rust 语言服务器

## 📖 扩展资源

### 官方文档
- [Vite](https://vitejs.dev/)
- [React](https://react.dev/)
- [Tailwind CSS](https://tailwindcss.com/)
- [Axum](https://docs.rs/axum/)
- [SeaORM](https://www.sea-ql.org/SeaORM/)
- [Rust 程序设计语言](https://kaisery.github.io/trpl-zh-cn/)

### 学习资源
- [React 官方教程](https://react.dev/learn)
- [Rust 实战指南](https://rust-lang.github.io/async-book/)
- [Axum 示例](https://github.com/tokio-rs/axum/tree/main/examples)
- [TypeScript 手册](https://www.typescriptlang.org/docs/)

---

按照这个指导文档，你应该能快速搭建起完整的开发环境，并开始高效的全栈开发。遇到问题时，优先查阅官方文档，然后参考社区最佳实践。

不断学习，持续优化，享受开发的乐趣！ 🚀